{"version":3,"sources":["../src/library.js"],"names":["define","$","cfg","log","str","sharedresourceslibrary","strs","init","args","get_strings","key","component","done","s","that","hover","css","bind","toggle_info_panel","on","ajax_mark_like","integrate","confirm","debug","identifier","attr","replace","arr","split","repoid","residentifier","url","wwwroot","get","data","html","sharedresource_print_stars","stars","maxstars","i","icon","pixicon","imgid","iconsrc","matches","match","command","ix","document","forms","mode","value","submit","e","strindex","hasClass","preventDefault","stopImmediatePropagation"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *\n * @module     local_sharedresource/library\n * @package    local\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n// jshint unused: true, undef:true\ndefine(['jquery', 'core/config', 'core/log', 'core/str'], function ($, cfg, log, str) {\n\n    var sharedresourceslibrary = {\n\n        strs: [],\n\n        init: function (args) {\n\n            var stringdefs = [\n                {key: 'confirmresourceforcedeletion', component: 'local_sharedresources'}, // 0\n                {key: 'confirmresourcedeletion', component: 'local_sharedresources'}, // 1\n            ];\n\n            str.get_strings(stringdefs).done(function(s) {\n                sharedresourceslibrary.strs = s;\n            });\n\n            var that = $(this);\n\n            // Resourceitem hover effect.\n            $('.resourceitem').hover(\n                function() {\n                    that.css('background-color','#fcfcfc');\n                },\n                function() {\n                    that.css('background-color','#f8f8f8');\n                }\n            );\n\n            $('.sharedresource-toggle-handle').bind('click', this.toggle_info_panel);\n            $('.sharedresource-mark-like').on('click', '', args, this.ajax_mark_like);\n            $('.sharedresource-actionlink').bind('click', this.integrate);\n            $('.sharedresource.delete').bind('click', this.confirm);\n            $('.sharedresource.force-delete').bind('click', this.confirm);\n\n            log.debug('ADM Shared resource Library JS initialized');\n        },\n\n        ajax_mark_like: function () {\n\n            var identifier = $(this).attr('id').replace('sharedresource-', '');\n            var arr = identifier.split('-'); // Has repo-resid form.\n            var repoid = arr[0];\n            var residentifier = arr[1];\n\n            var url = cfg.wwwroot + '/local/sharedresources/ajax/add_liked_mark.php?';\n            url += 'resid=' + residentifier + '&repo=' + repoid;\n\n            $.get(url, '', function(data) {\n                $('#sharedresource-likes-' + residentifier).html(sharedresourceslibrary.sharedresource_print_stars(data, 15));\n            }, 'html');\n        },\n\n        sharedresource_print_stars: function (stars, maxstars) {\n\n            var str = '';\n\n            for (var i = 0; i < maxstars; i++) {\n                var icon = (i < stars) ? 'star' : 'star_shadow';\n                var pixicon = cfg.wwwroot + '/local/sharedresources/pix/' + icon + '.png';\n                str += '<img src=\"'+ pixicon + '\" />';\n            }\n            return str;\n        },\n\n        toggle_info_panel: function () {\n\n            var that = $(this);\n\n            var imgid = that.attr('id');\n            var iconsrc;\n            var residentifier = imgid.replace('sharedresource-toggle-', '');\n\n            if ($('#sharedresource-info-' + residentifier).css('display') === 'none') {\n                $('#sharedresource-info-' + residentifier).css('display', 'block');\n                $('#sharedresource-social-' + residentifier).css('display', 'block');\n                iconsrc = $('#sharedresource-toggle-' + residentifier).attr('src');\n                iconsrc = iconsrc.replace('right', 'top');\n                $('#sharedresource-toggle-' + residentifier).attr('src', iconsrc);\n            } else {\n                $('#sharedresource-info-' + residentifier).css('display', 'none');\n                $('#sharedresource-social-' + residentifier).css('display', 'none');\n                iconsrc = $('#sharedresource-toggle-' + residentifier).attr('src');\n                iconsrc = iconsrc.replace('top', 'right');\n                $('#sharedresource-toggle-' + residentifier).attr('src', iconsrc);\n            }\n        },\n\n        integrate: function() {\n\n            var that = $(this);\n\n            var matches = that.attr('id').match(/id-(\\w+)-(\\d+)/);\n            var command = matches[1];\n            var ix = matches[2];\n            document.forms['add' + ix].mode.value = command;\n            document.forms['add' + ix].submit();\n        },\n\n        confirm: function(e) {\n\n            var that = $(this);\n\n            var strindex = 0;\n            if (that.hasClass('delete')) {\n                strindex = 1;\n            }\n\n            if (!confirm(sharedresourceslibrary.strs[strindex])) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                return false;\n            }\n        }\n\n    };\n\n    return sharedresourceslibrary;\n});"],"file":"library.min.js"}